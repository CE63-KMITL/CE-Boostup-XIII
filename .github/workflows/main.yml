name: Generate PlantUML SVG and Save Image

permissions:
     contents: write

on:
     push:
          branches:
               - main

jobs:
     generate-plantuml-svg:
          runs-on: ubuntu-latest

          steps:
               - name: Checkout repository
                 uses: actions/checkout@v2

               - name: Gen image
                 run: |
                      npm install node-plantuml -g
                      puml generate Plan.puml -o Plan.svg -s

               - name: Commit and push the generated SVG
                 env:
                      GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                 run: |
                      git config --global user.name "GitHub Actions"
                      git config --global user.email "actions@github.com"
                      git add Plan.svg
                      git commit -m "Add generated Plan.puml SVG" || echo "No changes to commit"
                      git push
